<?php $__env->startSection('style'); ?>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-body">
                <h1 id="timeline">LINEA DE TIEMPO</h1>

                <div id="timeline-scroll">
                    <ul id="results" class="timeline"></ul>
                </div>
                <?php /*<div class="animation_image" style="display:none;" align="center">*/ ?>
                    <?php /*<?php echo HTML::image('images/ajax-loader.gif'); ?>*/ ?>
                <?php /*</div>*/ ?>
            </div>
        </div>
    </div>
</div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('script'); ?>
<script type="text/javascript">
    var track_load = 0;
    var loading  = false;
    var total_groups = <?php echo $total_groups; ?>;
    $('.animation_image').centerToWindow();

    $('#results').load(url_developer+"/timeline", {'page':track_load }, function() {
        track_load++;
    });

    $('#timeline-scroll').scroll(function() {
        var s_top   = parseInt($('#timeline-scroll').scrollTop());
        var w_hei   = parseInt($('#timeline-scroll').outerHeight());
        var res_hei = parseInt($('#timeline-scroll')[0].scrollHeight);
        var tot     = parseInt(s_top+w_hei);

        // console.log("TOT: " + parseInt(tot));
        // console.log("RES_HEI: "+ parseInt($('#timeline-scroll')[0].scrollHeight));
        // console.log("-> (: "+  parseInt(-tot));

            if(parseInt(res_hei - tot) == 0) {
                if(track_load <= total_groups && loading==false) {
                    loading = true;
                    $('.animation_image').show();

                    $.post(url_developer+'/timeline',{'group_no': track_load}, function(data) {
                        $("#results").append(data);
                        $('.animation_image').hide();

                        track_load++;
                        loading = false;

                    }).fail(function(xhr, ajaxOptions, thrownError) {
                        alert(thrownError);
                        $('.animation_image').hide();
                        loading = false;
                    });
                }
            }
        });
</script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('layouts.dashboard', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>